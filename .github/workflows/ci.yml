name: CI

# Build & test on push and pull-request for major platforms. This workflow
# intentionally does not enable the interactive integration tests by default.
# Integration tests are gated behind AXIDEV_IO_RUN_INTEGRATION_TESTS and should
# be executed via the manual `integration-tests` workflow when desired.
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build-ubuntu-x64:
    name: Build (Ubuntu x64)
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/build-linux
        with:
          arch: x64
          build-type: Release
          build-tests: "true"
          run-tests: "true"

  build-windows-x64:
    name: Build (Windows x64)
    runs-on: windows-latest
    steps:
      - uses: ./.github/actions/build-windows-mingw
        with:
          arch: x64
          build-type: Release
          build-tests: "true"
          run-tests: "true"
